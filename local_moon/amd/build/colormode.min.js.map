{"version":3,"file":"colormode.min.js","sources":["../src/colormode.js"],"sourcesContent":["// local/moon/amd/src/colormode.js\ndefine([], function() {\n    /**\n     * Set a cookie\n     * @param {string} name The cookie name\n     * @param {string} value The cookie value\n     * @param {number} days Expiry in days\n     */\n    function setCookie(name, value, days) {\n        let expires = \"\";\n        if (days) {\n            const date = new Date();\n            date.setTime(date.getTime() + (days*24*60*60*1000));\n            expires = \"; expires=\" + date.toUTCString();\n        }\n        document.cookie = name + \"=\" + encodeURIComponent(value || \"\") + expires + \"; path=/\";\n    }\n\n    return {\n        /**\n         * Initialize the color mode switcher\n         * @param {string} mode The cookie name\n         * @param {string} templatehash The template hash\n         */\n        init: function(mode, templatehash) {\n            const switchers = Array.from(document.querySelectorAll('.moon-color-mode .switcher'));\n            let color_mode = 'light';\n            const cmCookieName = 'moon-color-mode-' + templatehash;\n            const acm = ('; ' + document.cookie).split(`; ` + cmCookieName + `=`).pop().split(';')[0];\n\n            if (acm === 'light') {\n                switchers.forEach(s => { s.checked = false; });\n                color_mode = 'light';\n            } else if (acm === 'dark') {\n                switchers.forEach(s => { s.checked = true; });\n                color_mode = 'dark';\n            } else if (mode === 'auto') {\n                const cur_hour = new Date().getHours();\n                if ((24 - cur_hour < 7) || (cur_hour < 6)) {\n                    color_mode = 'dark';\n                }\n                const checked = (color_mode === 'dark');\n                switchers.forEach(s => { s.checked = checked; });\n            } else {\n                color_mode = mode;\n            }\n\n            document.documentElement.setAttribute('data-bs-theme', color_mode);\n\n            switchers.forEach(s => {\n                s.addEventListener('change', (e) => {\n                    const checked = e.target.checked;\n                    switchers.forEach(s => { s.checked = checked; });\n                    const mode = checked ? 'dark' : 'light';\n                    document.documentElement.setAttribute('data-bs-theme', mode);\n                    setCookie('moon-color-mode-' + templatehash, mode, 3);\n                });\n            });\n        }\n    };\n});"],"names":["define","init","mode","templatehash","switchers","Array","from","document","querySelectorAll","color_mode","cmCookieName","acm","cookie","split","pop","forEach","s","checked","cur_hour","Date","getHours","documentElement","setAttribute","addEventListener","e","target","name","value","days","expires","date","setTime","getTime","toUTCString","encodeURIComponent","setCookie"],"mappings":"AACAA,8BAAO,IAAI,iBAiBA,CAMHC,KAAM,SAASC,KAAMC,oBACXC,UAAYC,MAAMC,KAAKC,SAASC,iBAAiB,mCACnDC,WAAa,cACXC,aAAe,mBAAqBP,aACpCQ,KAAO,KAAOJ,SAASK,QAAQC,MAAO,KAAMH,aAAgB,KAAII,MAAMD,MAAM,KAAK,MAE3E,UAARF,IACAP,UAAUW,SAAQC,IAAOA,EAAEC,SAAU,KACrCR,WAAa,aACV,GAAY,SAARE,IACPP,UAAUW,SAAQC,IAAOA,EAAEC,SAAU,KACrCR,WAAa,YACV,GAAa,SAATP,KAAiB,OAClBgB,UAAW,IAAIC,MAAOC,YACvB,GAAKF,SAAW,GAAOA,SAAW,KACnCT,WAAa,cAEXQ,QAA0B,SAAfR,WACjBL,UAAUW,SAAQC,IAAOA,EAAEC,QAAUA,gBAErCR,WAAaP,KAGjBK,SAASc,gBAAgBC,aAAa,gBAAiBb,YAEvDL,UAAUW,SAAQC,IACdA,EAAEO,iBAAiB,UAAWC,UACpBP,QAAUO,EAAEC,OAAOR,QACzBb,UAAUW,SAAQC,IAAOA,EAAEC,QAAUA,iBAC/Bf,KAAOe,QAAU,OAAS,QAChCV,SAASc,gBAAgBC,aAAa,gBAAiBpB,eA9CpDwB,KAAMC,MAAOC,UACxBC,QAAU,MACVD,KAAM,OACAE,KAAO,IAAIX,KACjBW,KAAKC,QAAQD,KAAKE,UAAkB,GAALJ,KAAQ,GAAG,GAAG,KAC7CC,QAAU,aAAeC,KAAKG,cAElC1B,SAASK,OAASc,KAAO,IAAMQ,mBAAmBP,OAAS,IAAME,QAAU,WAwC/DM,CAAU,mBAAqBhC,aAAcD,KAAM"}