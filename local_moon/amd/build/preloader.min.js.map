{"version":3,"file":"preloader.min.js","sources":["../src/preloader.js"],"sourcesContent":["// local/moon/amd/src/preloader.js\ndefine([], function() {\n    return {\n        /**\n         * Initialize the preloader fade out\n         * @param {number|string} duration Duration in milliseconds (number) or a CSS time string (e.g. \"400ms\" or \"0.4s\")\n         */\n        init: function(duration) {\n            /**\n             * Normalize the duration parameter to a CSS time string and a number of milliseconds.\n             * @param {number|string} d\n             * @returns {{css: string, ms: number}|{css: string, ms: number}}\n             */\n            function normalizeDuration(d) {\n                let defaultMs = 400;\n                if (typeof d === 'number' && isFinite(d)) {\n                    return { css: d + 'ms', ms: d };\n                }\n                if (typeof d === 'string') {\n                    let s = d.trim();\n                    if (/^\\d+$/.test(s)) {\n                        let n = parseInt(s, 10);\n                        return { css: n + 'ms', ms: n };\n                    }\n                    if (/^\\d+ms$/.test(s)) {\n                        return { css: s, ms: parseInt(s, 10) };\n                    }\n                    if (/^\\d+(\\.\\d+)?s$/.test(s)) {\n                        let sec = parseFloat(s);\n                        return { css: s, ms: Math.round(sec * 1000) };\n                    }\n                }\n                return { css: defaultMs + 'ms', ms: defaultMs };\n            }\n\n            let dur = normalizeDuration(duration);\n\n            /**\n             * Run the preloader fade out\n             */\n            function run() {\n                const preloader = document.getElementById('moon-preloader');\n                if (!preloader) {\n                    return;\n                }\n\n                // ensure visible and reset any previous inline styles\n                preloader.classList.remove('d-none');\n                preloader.classList.add('d-flex');\n                preloader.style.opacity = '1';\n                preloader.style.transition = 'opacity ' + dur.css + ' ease';\n\n                // trigger fade out on next frame\n                requestAnimationFrame(function() {\n                    preloader.style.opacity = '0';\n                });\n\n                // when transition ends, fully hide and clean up\n                const onEnd = function() {\n                    preloader.classList.remove('d-flex');\n                    preloader.classList.add('d-none');\n                    preloader.style.opacity = '';\n                    preloader.style.transition = '';\n                };\n\n                // use { once: true } to auto-remove the listener\n                preloader.addEventListener('transitionend', onEnd, { once: true });\n\n                // fallback: ensure it's hidden even if transitionend doesn't fire\n                setTimeout(function() {\n                    if (preloader && getComputedStyle(preloader).opacity === '0') {\n                        onEnd();\n                    }\n                }, dur.ms + 200);\n            }\n\n            if (document.readyState === 'complete') {\n                run();\n            } else {\n                window.addEventListener('load', run);\n            }\n        }\n    };\n});\n"],"names":["define","init","duration","dur","d","isFinite","css","ms","s","trim","test","n","parseInt","sec","parseFloat","Math","round","defaultMs","normalizeDuration","run","preloader","document","getElementById","classList","remove","add","style","opacity","transition","requestAnimationFrame","onEnd","addEventListener","once","setTimeout","getComputedStyle","readyState","window"],"mappings":"AACAA,8BAAO,IAAI,iBACA,CAKHC,KAAM,SAASC,cA4BPC,aAtBuBC,MAEN,iBAANA,GAAkBC,SAASD,SAC3B,CAAEE,IAAKF,EAAI,KAAMG,GAAIH,MAEf,iBAANA,EAAgB,KACnBI,EAAIJ,EAAEK,UACN,QAAQC,KAAKF,GAAI,KACbG,EAAIC,SAASJ,EAAG,UACb,CAAEF,IAAKK,EAAI,KAAMJ,GAAII,MAE5B,UAAUD,KAAKF,SACR,CAAEF,IAAKE,EAAGD,GAAIK,SAASJ,EAAG,QAEjC,iBAAiBE,KAAKF,GAAI,KACtBK,IAAMC,WAAWN,SACd,CAAEF,IAAKE,EAAGD,GAAIQ,KAAKC,MAAY,IAANH,aAGjC,CAAEP,IAAKW,QAAkBV,GAlBhB,KAqBVW,CAAkBhB,mBAKnBiB,YACCC,UAAYC,SAASC,eAAe,sBACrCF,iBAKLA,UAAUG,UAAUC,OAAO,UAC3BJ,UAAUG,UAAUE,IAAI,UACxBL,UAAUM,MAAMC,QAAU,IAC1BP,UAAUM,MAAME,WAAa,WAAazB,IAAIG,IAAM,QAGpDuB,uBAAsB,WAClBT,UAAUM,MAAMC,QAAU,aAIxBG,MAAQ,WACVV,UAAUG,UAAUC,OAAO,UAC3BJ,UAAUG,UAAUE,IAAI,UACxBL,UAAUM,MAAMC,QAAU,GAC1BP,UAAUM,MAAME,WAAa,IAIjCR,UAAUW,iBAAiB,gBAAiBD,MAAO,CAAEE,MAAM,IAG3DC,YAAW,WACHb,WAAqD,MAAxCc,iBAAiBd,WAAWO,SACzCG,UAEL3B,IAAII,GAAK,KAGY,aAAxBc,SAASc,WACThB,MAEAiB,OAAOL,iBAAiB,OAAQZ"}